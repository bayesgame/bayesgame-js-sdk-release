"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../../../../../../_virtual/mask-pattern.js");!function(t){t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};var e=3,r=3,a=40,n=10;function s(e,r,a){switch(e){case t.Patterns.PATTERN000:return(r+a)%2==0;case t.Patterns.PATTERN001:return r%2==0;case t.Patterns.PATTERN010:return a%3==0;case t.Patterns.PATTERN011:return(r+a)%3==0;case t.Patterns.PATTERN100:return(Math.floor(r/2)+Math.floor(a/3))%2==0;case t.Patterns.PATTERN101:return r*a%2+r*a%3==0;case t.Patterns.PATTERN110:return(r*a%2+r*a%3)%2==0;case t.Patterns.PATTERN111:return(r*a%3+(r+a)%2)%2==0;default:throw new Error("bad maskPattern:"+e)}}t.isValid=function(t){return null!=t&&""!==t&&!isNaN(t)&&t>=0&&t<=7},t.from=function(e){return t.isValid(e)?parseInt(e,10):void 0},t.getPenaltyN1=function(t){for(var r=t.size,a=0,n=0,s=0,u=null,P=null,o=0;o<r;o++){n=s=0,u=P=null;for(var T=0;T<r;T++){var l=t.get(o,T);l===u?n++:(n>=5&&(a+=e+(n-5)),u=l,n=1),(l=t.get(T,o))===P?s++:(s>=5&&(a+=e+(s-5)),P=l,s=1)}n>=5&&(a+=e+(n-5)),s>=5&&(a+=e+(s-5))}return a},t.getPenaltyN2=function(t){for(var e=t.size,a=0,n=0;n<e-1;n++)for(var s=0;s<e-1;s++){var u=t.get(n,s)+t.get(n,s+1)+t.get(n+1,s)+t.get(n+1,s+1);4!==u&&0!==u||a++}return a*r},t.getPenaltyN3=function(t){for(var e=t.size,r=0,n=0,s=0,u=0;u<e;u++){n=s=0;for(var P=0;P<e;P++)n=n<<1&2047|t.get(u,P),P>=10&&(1488===n||93===n)&&r++,s=s<<1&2047|t.get(P,u),P>=10&&(1488===s||93===s)&&r++}return r*a},t.getPenaltyN4=function(t){for(var e=0,r=t.data.length,a=0;a<r;a++)e+=t.data[a];return Math.abs(Math.ceil(100*e/r/5)-10)*n},t.applyMask=function(t,e){for(var r=e.size,a=0;a<r;a++)for(var n=0;n<r;n++)e.isReserved(n,a)||e.xor(n,a,s(t,n,a))},t.getBestMask=function(e,r){for(var a=Object.keys(t.Patterns).length,n=0,s=1/0,u=0;u<a;u++){r(u),t.applyMask(u,e);var P=t.getPenaltyN1(e)+t.getPenaltyN2(e)+t.getPenaltyN3(e)+t.getPenaltyN4(e);t.applyMask(u,e),P<s&&(s=P,n=u)}return n}}(t.__exports),exports.default=t.__exports;
