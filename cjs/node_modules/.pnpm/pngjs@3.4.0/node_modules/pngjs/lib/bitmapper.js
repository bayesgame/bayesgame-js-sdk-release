"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var r=require("../../../../../../_virtual/bitmapper.js");require("./interlace.js");var t=require("../../../../../../_virtual/interlace.js").__exports,e=[function(){},function(r,t,e,n){if(n===t.length)throw new Error("Ran out of data");var a=t[n];r[e]=a,r[e+1]=a,r[e+2]=a,r[e+3]=255},function(r,t,e,n){if(n+1>=t.length)throw new Error("Ran out of data");var a=t[n];r[e]=a,r[e+1]=a,r[e+2]=a,r[e+3]=t[n+1]},function(r,t,e,n){if(n+2>=t.length)throw new Error("Ran out of data");r[e]=t[n],r[e+1]=t[n+1],r[e+2]=t[n+2],r[e+3]=255},function(r,t,e,n){if(n+3>=t.length)throw new Error("Ran out of data");r[e]=t[n],r[e+1]=t[n+1],r[e+2]=t[n+2],r[e+3]=t[n+3]}],n=[function(){},function(r,t,e,n){var a=t[0];r[e]=a,r[e+1]=a,r[e+2]=a,r[e+3]=n},function(r,t,e){var n=t[0];r[e]=n,r[e+1]=n,r[e+2]=n,r[e+3]=t[1]},function(r,t,e,n){r[e]=t[0],r[e+1]=t[1],r[e+2]=t[2],r[e+3]=n},function(r,t,e){r[e]=t[0],r[e+1]=t[1],r[e+2]=t[2],r[e+3]=t[3]}];function a(r,t,n,a,o,i){for(var f=r.width,u=r.height,h=r.index,c=0;c<u;c++)for(var s=0;s<f;s++){var d=n(s,c,h);e[a](t,o,d,i),i+=a}return i}function o(r,t,e,a,o,i){for(var f=r.width,u=r.height,h=r.index,c=0;c<u;c++){for(var s=0;s<f;s++){var d=o.get(a),l=e(s,c,h);n[a](t,d,l,i)}o.resetAfterLine()}}r.__exports.dataToBitMap=function(r,e){var n,i=e.width,f=e.height,u=e.depth,h=e.bpp,c=e.interlace;if(8!==u)var s=function(r,t){var e=[],n=0;function a(){if(n===r.length)throw new Error("Ran out of data");var a,o,i,f,u,h,c,s,d=r[n];switch(n++,t){default:throw new Error("unrecognised depth");case 16:c=r[n],n++,e.push((d<<8)+c);break;case 4:c=15&d,s=d>>4,e.push(s,c);break;case 2:u=3&d,h=d>>2&3,c=d>>4&3,s=d>>6&3,e.push(s,c,h,u);break;case 1:a=1&d,o=d>>1&1,i=d>>2&1,f=d>>3&1,u=d>>4&1,h=d>>5&1,c=d>>6&1,s=d>>7&1,e.push(s,c,h,u,f,i,o,a)}}return{get:function(r){for(;e.length<r;)a();var t=e.slice(0,r);return e=e.slice(r),t},resetAfterLine:function(){e.length=0},end:function(){if(n!==r.length)throw new Error("extra data found")}}}(r,u);n=u<=8?new Buffer(i*f*4):new Uint16Array(i*f*4);var d,l,v=Math.pow(2,u)-1,w=0;if(c)d=t.getImagePasses(i,f),l=t.getInterlaceIterator(i,f);else{var g=0;l=function(){var r=g;return g+=4,r},d=[{width:i,height:f}]}for(var p=0;p<d.length;p++)8===u?w=a(d[p],n,l,h,r,w):o(d[p],n,l,h,s,v);if(8===u){if(w!==r.length)throw new Error("extra data found")}else s.end();return n},exports.default=r.__exports;
