"use strict";var e=require("../../../../../../_virtual/sync-inflate.js"),t=require("assert"),n=require("zlib"),r=require("util"),f=require("buffer");function i(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var s=i(t),u=i(n),o=i(r),h=i(f);!function(e,t){var n=s.default.ok,r=u.default,f=o.default,i=h.default.kMaxLength;function a(e){if(!(this instanceof a))return new a(e);e&&e.chunkSize<r.Z_MIN_CHUNK&&(e.chunkSize=r.Z_MIN_CHUNK),r.Inflate.call(this,e),this._offset=void 0===this._offset?this._outOffset:this._offset,this._buffer=this._buffer||this._outBuffer,e&&null!=e.maxLength&&(this._maxLength=e.maxLength)}function l(e,t){t&&process.nextTick(t),e._handle&&(e._handle.close(),e._handle=null)}function c(e,t){return function(e,t){if("string"==typeof t&&(t=Buffer.from(t)),!(t instanceof Buffer))throw new TypeError("Not a string or buffer");var n=e._finishFlushFlag;return null==n&&(n=r.Z_FINISH),e._processChunk(t,n)}(new a(t),e)}a.prototype._processChunk=function(e,t,f){if("function"==typeof f)return r.Inflate._processChunk.call(this,e,t,f);var s,u=this,o=e&&e.length,h=this._chunkSize-this._offset,a=this._maxLength,c=0,_=[],d=0;function g(e,t){if(!u._hadError){var r=h-t;if(n(r>=0,"have should not go down"),r>0){var f=u._buffer.slice(u._offset,u._offset+r);if(u._offset+=r,f.length>a&&(f=f.slice(0,a)),_.push(f),d+=f.length,0===(a-=f.length))return!1}return(0===t||u._offset>=u._chunkSize)&&(h=u._chunkSize,u._offset=0,u._buffer=Buffer.allocUnsafe(u._chunkSize)),0===t&&(c+=o-e,o=e,!0)}}this.on("error",(function(e){s=e})),n(this._handle,"zlib binding closed");do{var b=this._handle.writeSync(t,e,c,o,this._buffer,this._offset,h);b=b||this._writeState}while(!this._hadError&&g(b[0],b[1]));if(this._hadError)throw s;if(d>=i)throw l(this),new RangeError("Cannot create final Buffer. It would be larger than 0x"+i.toString(16)+" bytes");var p=Buffer.concat(_,d);return l(this),p},f.inherits(a,r.Inflate),e.exports=t=c,t.Inflate=a,t.createInflate=function(e){return new a(e)},t.inflateSync=c}(e.syncInflate,e.syncInflate.exports);
