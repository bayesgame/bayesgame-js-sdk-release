"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var t,n,r=e(require("stream"));exports.__require=function(){if(n)return t;n=1;const{Duplex:e}=r.default;function o(e){e.emit("close")}function i(){!this.destroyed&&this._writableState.finished&&this.destroy()}function s(e){this.removeListener("error",s),this.destroy(),0===this.listenerCount("error")&&this.emit("error",e)}return t=function(t,n){let r=!0,c=!0;function u(){r&&t._socket.resume()}t.readyState===t.CONNECTING?t.once("open",(function(){t._receiver.removeAllListeners("drain"),t._receiver.on("drain",u)})):(t._receiver.removeAllListeners("drain"),t._receiver.on("drain",u));const a=new e({...n,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return t.on("message",(function(e){a.push(e)||(r=!1,t._socket.pause())})),t.once("error",(function(e){a.destroyed||(c=!1,a.destroy(e))})),t.once("close",(function(){a.destroyed||a.push(null)})),a._destroy=function(e,n){if(t.readyState===t.CLOSED)return n(e),void process.nextTick(o,a);let r=!1;t.once("error",(function(e){r=!0,n(e)})),t.once("close",(function(){r||n(e),process.nextTick(o,a)})),c&&t.terminate()},a._final=function(e){t.readyState!==t.CONNECTING?null!==t._socket&&(t._socket._writableState.finished?(e(),a._readableState.endEmitted&&a.destroy()):(t._socket.once("finish",(function(){e()})),t.close())):t.once("open",(function(){a._final(e)}))},a._read=function(){t.readyState!==t.OPEN||r||(r=!0,t._receiver._writableState.needDrain||t._socket.resume())},a._write=function(e,n,r){t.readyState!==t.CONNECTING?t.send(e,r):t.once("open",(function(){a._write(e,n,r)}))},a.on("end",i),a.on("error",s),a}};
